[INFO] 14:18:18,812 - AgentServer.main - Begin to start AgentServer...
[INFO] 14:18:18,837 - ConfigUtil.loadJsConfig - Load js config, file: agent_server.cfg.js
[INFO] 14:18:19,645 - JavaReflectionManager.<clinit> - HCANN000001: Hibernate Commons Annotations {4.0.5.Final}
[INFO] 14:18:19,653 - Version.logVersion - HHH000412: Hibernate Core {4.3.8.Final}
[INFO] 14:18:19,655 - Environment.<clinit> - HHH000206: hibernate.properties not found
[INFO] 14:18:19,656 - Environment.buildBytecodeProvider - HHH000021: Bytecode provider name : javassist
[INFO] 14:18:19,678 - Configuration.configure - HHH000044: Configuring from URL: file:/E:/git/Stone/db/bin/game_server_hibernate.cfg.xml
[WARN] 14:18:19,718 - DTDEntityResolver.resolveEntity - HHH000223: Recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
[INFO] 14:18:19,743 - Configuration.addResource - HHH000221: Reading mappings from resource: game_server_hibernate_query.xml
[WARN] 14:18:19,771 - DTDEntityResolver.resolveEntity - HHH000223: Recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!
[INFO] 14:18:19,796 - Configuration.doConfigure - HHH000041: Configured SessionFactory: null
[INFO] 14:18:19,873 - ConnectionProviderInitiator.instantiateExplicitConnectionProvider - HHH000130: Instantiating explicit connection provider: org.hibernate.connection.C3P0ConnectionProvider
[INFO] 14:18:19,899 - C3P0ConnectionProvider.configure - HHH010002: C3P0 using driver: com.mysql.jdbc.Driver at URL: jdbc:mysql://localhost:3306/stone?useUnicode=true&characterEncoding=utf-8&useServerPrepStmts=true
[INFO] 14:18:19,900 - C3P0ConnectionProvider.configure - HHH000046: Connection properties: {useUnicode=true, user=root, password=****, characterEncoding=UTF-8}
[INFO] 14:18:19,900 - C3P0ConnectionProvider.configure - HHH000006: Autocommit mode: false
[INFO] 14:18:19,912 - MLog.<clinit> - MLog clients using log4j logging.
[INFO] 14:18:20,056 - C3P0Registry.banner - Initializing c3p0-0.9.2.1 [built 20-March-2013 10:47:27 +0000; debug? true; trace: 10]
[INFO] 14:18:20,119 - AbstractPoolBackedDataSource.getPoolManager - Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@ccaf8f1f [ connectionPoolDataSource -> com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@acba6674 [ acquireIncrement -> 3, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, debugUnreturnedConnectionStackTraces -> false, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, identityToken -> 2rvy2d9b1oh2tnomlwkm5|210c2ed8, idleConnectionTestPeriod -> 0, initialPoolSize -> 5, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 1800, maxIdleTimeExcessConnections -> 0, maxPoolSize -> 20, maxStatements -> 50, maxStatementsPerConnection -> 0, minPoolSize -> 5, nestedDataSource -> com.mchange.v2.c3p0.DriverManagerDataSource@1accbd14 [ description -> null, driverClass -> null, factoryClassLocation -> null, identityToken -> 2rvy2d9b1oh2tnomlwkm5|1f56e60b, jdbcUrl -> jdbc:mysql://localhost:3306/stone?useUnicode=true&characterEncoding=utf-8&useServerPrepStmts=true, properties -> {useUnicode=true, user=******, password=******, characterEncoding=UTF-8} ], preferredTestQuery -> null, propertyCycle -> 0, statementCacheNumDeferredCloseThreads -> 0, testConnectionOnCheckin -> false, testConnectionOnCheckout -> true, unreturnedConnectionTimeout -> 0, usesTraditionalReflectiveProxies -> false; userOverrides: {} ], dataSourceName -> null, factoryClassLocation -> null, identityToken -> 2rvy2d9b1oh2tnomlwkm5|708a538f, numHelperThreads -> 3 ]
[INFO] 14:18:20,304 - Dialect.<init> - HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
[INFO] 14:18:20,311 - LobCreatorBuilder.useContextualLobCreation - HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
[INFO] 14:18:20,423 - TransactionFactoryInitiator.initiateService - HHH000399: Using default transaction strategy (direct JDBC transactions)
[INFO] 14:18:20,429 - ASTQueryTranslatorFactory.<init> - HHH000397: Using ASTQueryTranslatorFactory
[INFO] 14:18:20,823 - ServerNode.startup - ServerIoProcessor: internalProcessor started.
[INFO] 14:18:20,833 - ServerNode.startup - ServerIoProcessor: mainProcessor started.
[INFO] 14:18:20,834 - AgentServer.main - AgentServer started.
[ERROR] 14:18:42,632 - AbstractIoHandler.exceptionCaught - Exception caught, session: (0x00000001: nio socket, server, /10.0.1.53:63000 => /10.0.1.53:6001)
org.apache.mina.filter.codec.ProtocolDecoderException: com.stone.core.msg.MessageParseException:  Type: 101, typeName: GAME_REGISTER_TO_AGENT_VALUE (Hexdump: 00 12 00 00 00 65 08 01 12 08 08 02 12 04 67 61 6D 65)
	at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:241)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:48)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.fireMessageReceived(DefaultIoFilterChain.java:535)
	at org.apache.mina.core.polling.AbstractPollingIoProcessor.read(AbstractPollingIoProcessor.java:714)
	at org.apache.mina.core.polling.AbstractPollingIoProcessor.process(AbstractPollingIoProcessor.java:668)
	at org.apache.mina.core.polling.AbstractPollingIoProcessor.process(AbstractPollingIoProcessor.java:657)
	at org.apache.mina.core.polling.AbstractPollingIoProcessor.access$600(AbstractPollingIoProcessor.java:67)
	at org.apache.mina.core.polling.AbstractPollingIoProcessor$Processor.run(AbstractPollingIoProcessor.java:1121)
	at org.apache.mina.util.NamePreservingRunnable.run(NamePreservingRunnable.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.stone.core.msg.MessageParseException:  Type: 101, typeName: GAME_REGISTER_TO_AGENT_VALUE
	at com.stone.core.msg.BaseMessage.read(BaseMessage.java:96)
	at com.stone.core.codec.GameDecoder.decode(GameDecoder.java:49)
	at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:233)
	... 15 more
Caused by: java.nio.BufferUnderflowException
	at java.nio.Buffer.nextGetIndex(Buffer.java:498)
	at java.nio.HeapByteBuffer.getShort(HeapByteBuffer.java:304)
	at org.apache.mina.core.buffer.AbstractIoBuffer.getShort(AbstractIoBuffer.java:765)
	at com.stone.core.msg.BaseMessage.readString(BaseMessage.java:371)
	at com.stone.core.msg.BaseMessage.readString(BaseMessage.java:367)
	at com.stone.core.msg.server.AGForwardMessage.readBody(AGForwardMessage.java:44)
	at com.stone.core.msg.BaseMessage.read(BaseMessage.java:94)
	... 17 more
